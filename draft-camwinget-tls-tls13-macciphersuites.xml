<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY RFC4492 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4492.xml">
  <!ENTITY RFC5246 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5246.xml">
  <!ENTITY RFC4634 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4634.xml">
<!ENTITY I-D.ietf-tls-tls13 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-tls-tls13.xml">
  ]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- OPTIONS, known as processing instructions (PIs) go here. -->
<!-- For a complete list and description of PIs,
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable PIs that most I-Ds might want to use. -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC): -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="2"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references: -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space: 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start eacddh main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of popular PIs -->
<rfc category="info" docName="draft-camwinget-tls-ts13-macciphersuites" ipr="trust200902">
  <front>
    <title abbrev="IoT Ciphers">TLS 1.3 Authentication and Integrity only Ciphersuites</title>
    <author fullname="Nancy Cam-Winget" initials="N" surname="Cam-Winget">
      <organization>Cisco Systems</organization>
      <address>
        <postal>
          <street>3550 Cisco Way </street>
          <city>San Jose</city>
          <country>USA</country>
          <code>95134</code>
          <region>CA</region>
        </postal>
        <email>ncamwing@cisco.com</email>
      </address>
    </author>
    <author fullname="Jack Visoky" initials="J" surname="Visoky">
      <organization>ODVA</organization>
      <address>
        <postal>
          <street>1 Allen Bradley Dr </street>
          <city>Mayfield Heights</city>
          <code>44124</code>
          <country>USA</country>
          <region>OH</region>
        </postal>
        <email>jmvisoky@ra.rockwell.com</email>
      </address>
    </author>
    
    <date/>
    <area>Security</area>
    <workgroup>TLS</workgroup>
    <!-- <keyword/> -->
    <!-- <keyword/> -->
    <!-- <keyword/> -->
    <!-- <keyword/> -->
    <abstract>
      <t>There are use cases, specifically in Internet of Things (IoT) and constrained environments do not require confidentiality, though mutual authentication during tunnel establishment and message integrity is still mandated. This document defines the use of HMAC only as ciphersuites in TLS 1.3.</t>
    </abstract>
  </front>
  <middle>

    <section title="Introduction">
        <t>There are several use cases in which communications privacy is not strictly needed, although authenticity of the communications transport is still very important.  For example, within the Industrial Automation space there could be TCP or UDP communications which command a robotic arm to move a certain distance at a certain speed.  Without authenticity guarantees an attacker could modify the packets to change the movement of the robotic arm, potentially causing physical damage.  However, the motion control commands are not considered to be sensitive information and thus there is no requirement to provide confidentiality. Another IoT example with no strong requirement for confidentiality is the reporting of weather information; however, message authenticity is required to ensure integrity of the message..</t>
      <t>Besides having a strong need for authenticity and a weak need for confidentiality, many of these systems also have serious latency requirements.  Furthermore, several IoT devices (industrial or otherwise) have limited processing capability.  However, these IoT systems still gain great benefit from leveraging TLS 1.3 for secure communications.  Given the reduced need for confidentiality TLS 1.3 <xref target="I-D.ietf-tls-tls13"/> cipher suites that maintain data integrity without confidentiality are described in this document. </t>
     

    </section>

    <section title="Terminology">
            <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119"/>.</t>
    </section>
    
    <section title="Applicability Statement">
        <t>The ciphersuites defined in this document are intended for a small limited set of applications where confidentiality requirements are relaxed and the need to minimize the cryptographic algorithms are prioritized. This section describes some of those applicable use cases. </t>
        
        <t>Use cases in the industrial automation industry, while requiring data integrity, relax the confidential communications requirement. Mainly, information communicated to unmanned machines to execute repetitive
            tasks do not convey private information. For example, there could be a system with a robotic arm that is doing high speed pick-and-place of materials.  The position synchronization data and motion commands are required to have very low latency, as the process needs to be done at high speed on a compute and memory constrained device. However, information such as the position, speed, acceleration of the robotic arm or other material in the system is not confidential.  That is, while an attacker can determine the behavioral aspects and task of the device; no intellectual property concerns or data privacy concerns exist for these communications.  However, data integrity is required as being able to modify this data would be a threat that an attacker might seek to exploit with serious consequences; the attacker could modify the motion information in order to cause physical damage to the equipment. </t>
         
        

        <t>Another use case which is closely related is that of fine grained time updates.  Motion systems often rely on time synchronization to ensure proper execution.  Time updates are essentially public, there is no threat from an attacker knowing the time update information.  This should make intuitive sense to those not familiar with these applications; rarely if ever does time information present a serious attack surface dealing with privacy.  However the authenticity is still quite important.  Modification of the data can at best lead to a denial-of-service attack, although a more intelligent threat actor might be able to cause actual physical damage.  As these time synchronization updates are very fine-grained, it is again important for latency to be very low.</t>
        
        <t>A third use case deals with Alarming data.  Industrial control sensing equipment can be configured to send alarm information when it meets certain conditions.  Often times this data is used to detect certain out-of-tolerance conditions, allowing an operator or automated system to take corrective action.  Once again, in many systems the reading of this data doesn't grant the attacker information that can be exploited, it is generally just information regarding the physical state of the system.  At the same time, being able to modify this data would allow an attacker to either trigger alarms falsely or to cover up evidence of an attack that might allow for detection of their malicious activity.  Furthermore, sensors are often low powered devices that might struggle to process encrypted and authenticated data.  Sending data that is just authenticated significantly eases the burden placed on these devices, yet still allows the data to be protected against any tampering threats. </t>
        <t> The above use cases describe the relaxed requirements to provide confidentiality, and as these devices come with a small runtime memory footprint, the need to minimize the number of cryptographic algorithms used is prioritized.</t>
        </section>

    <section title="Using Integrity only Cipher Suites">
        <t>This document defines the following cipher suites for use in TLS 1.3: </t>
        <t> <list style='hanging'>
            <t hangText='TLS_SHA256_SHA256'>  {0x13, TBD}</t>
            <t hangText='TLS_SHA384_SHA384'>  {0x13, TBD}</t>
            </list> </t>
        <t>
            These cipher suites allow the use of SHA-256 or SHA-384 as the HMACs for data integrity protection as well as its use for HKDF. The authentication mechanisms remain unchanged with the intent to only update the cipher suites to relax the need for confidentiality.</t>
    </section>
    
    <section title="Record Payload Protection for Integrity only Cipher Suites">
        <t> The record payload protection as defined in <xref target="I-D.ietf-tls-tls13"/> can be retained when integrity only cipher suites are used.
            This section describes the mapping of record payload structures when integrity only cipher suites are employed.
            </t>
        
        <t> As integrity is provided with protection over the full record, the encrypted_record in the TLSCiphertext along with the additional_data input to AEADEncrypted as defined in Section 5.2 <xref target="I-D.ietf-tls-tls13"/> remains the same.
            The TLSCiphertext.length for the integrity cipher suites will be: </t>
        <t> <list style='hanging'>
            <t hangText='TLS_SHA256_SHA256:'>   TLSPlaintext.length + 32</t>
            <t hangText='TLS_SHA384_SHA384:'>   TLSPlaintext.length + 64</t>
        </list> </t>
        <t> The resulting encrypted_record is the concatenation of the TLSPlaintext with the resulting HMAC. With this mapping, the decrypt order as defined in Section 5.2 of  <xref target="I-D.ietf-tls-tls13"/> remains the same. The encrypt and decrypt operations provide the integrity protection using HMAC SHA-256 or SHA-384 as described in <xref target="RFC4634"/>.</t>
        </section>
    
    <section title="Key Schedule when using Integrity only Cipher Suites">
        <t> The key derivation process for Integrity only Cipher Suites remains the same as defined in <xref target="I-D.ietf-tls-tls13"/>.  The only difference is that the keys used to protect the tunnel applies to the negotiated HMAC SHA-256 or HMAC SHA-384 ciphers. </t>
        </section>


    <section anchor="IANA" title="IANA Considerations">
        <t>  IANA is requested to register the following:</t>
        <t> This document requests a numbers be assigned for each TLS_SHA256_SHA256 and TLS_SHA384_SHA384 cipher suites. </t>
    </section>

    <section anchor="Security" title="Security and Privacy Considerations">
        <t>In general, with the exception of confidentiality and privacy, the security considerations detailed in <xref target="I-D.ietf-tls-tls13"/> and in <xref target="RFC5246"/> apply to this document.  Furthermore, as the cipher suites described in this document do not provide any confidentiality, it is important that they only be used in cases where there are no confidentiality requirements and concerns; and the runtime memory requirements can accommodate support for more cryptographic constructs.</t>
      <t>With the lack of data encryption specified in this draft, no confidentiality or privacy is provided for the data transported in the the TLS tunnel.
      </t>
    </section>
   
    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The authors would like to acknowledge the work done by Industrial Communications Standards Groups (such as ODVA) as the motivation for this document. In addition, we are grateful for the advice and feedback from Joe Salowey, Blake Anderson and David McGrew.</t>
    </section>
  </middle>
  <back>
    <references title="Normative References">
      &RFC2119;
      &I-D.ietf-tls-tls13;
      &RFC4634;

    </references>
    <references title="Informative Reference">
        &RFC5246;
        </references>
  </back>
</rfc>
